{
  "exitCode": 1,
  "stdout": "\n> tanstack-react-start-e2e-import-protection@ build /Users/caligano/source/import-protection/router-import-protection/e2e/react-start/import-protection\n> vite build && tsc --noEmit\n\n\u001b[36mvite v7.3.1 \u001b[32mbuilding client environment for production...\u001b[36m\u001b[39m\ntransforming...\n\u001b[32m✓\u001b[39m 152 modules transformed.\n\u001b[41m\u001b[30m ELIFECYCLE \u001b[39m\u001b[49m \u001b[31mCommand failed with exit code 1.\u001b[39m\n",
  "stderr": "\u001b[31m✗\u001b[39m Build failed in 719ms\n\u001b[31merror during build:\n\u001b[31m[commonjs--resolver] [plugin tanstack-start-core:import-protection] \n[import-protection] Import denied in client environment\n\n  Denied by specifier pattern: @tanstack/react-start/server\n  Importer: src/violations/leaky-server-import.ts:7:10\n  Import: \"@tanstack/react-start/server\"\n\n  Trace:\n    1. src/router.tsx:2:27 (entry) (import \"./routeTree.gen\")\n    2. src/routeTree.gen.ts:6:55 (import \"./routes/leaky-server-import\")\n    3. src/routes/leaky-server-import.tsx:2:38 (import \"../violations/leaky-server-import\")\n    4. src/violations/leaky-server-import.ts:7:10 (import \"@tanstack/react-start/server\")\n\n  Code:\n    5 | export function leakyGetRequestUsage() {\n    6 |   // Any reference keeps the import alive.\n  > 7 |   return getRequest()\n      |          ^\n    8 | }\n    9 | \n\n  src/violations/leaky-server-import.ts:7:10\n\n  Suggestions:\n    - Use createServerFn().handler(() => ...) to keep the logic on the server and call it from the client via an RPC bridge\n    - Use createServerOnlyFn(() => ...) to mark it as server-only (it will throw if accidentally called from the client)\n    - Use createIsomorphicFn().client(() => ...).server(() => ...) to provide separate client and server implementations\n    - Move the server-only import out of this file into a separate .server.ts module that is not imported by any client code\n\u001b[31m\n    at getRollupError (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/parseAst.js:401:41)\n    at error (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/parseAst.js:397:42)\n    at Object.error (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:22104:20)\n    at Object.handleViolation (file:///Users/caligano/source/import-protection/router-import-protection/packages/start-plugin-core/dist/esm/import-protection-plugin/plugin.js:652:23)\n    at Object.resolveId (file:///Users/caligano/source/import-protection/router-import-protection/packages/start-plugin-core/dist/esm/import-protection-plugin/plugin.js:452:34)\n    at async PluginDriver.hookFirstAndGetPlugin (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:22308:28)\n    at async resolveId (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:20785:26)\n    at async ModuleLoader.resolveId (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:21221:15)\n    at async Object.resolveId (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/vite@7.3.1_@types+node@25.0.9_jiti@2.6.1_lightningcss@1.30.2_sass-embedded@1.97.2_sass@_1d37aa1356b156747ad30a49305c26bc/node_modules/vite/dist/node/chunks/config.js:4154:21)\n    at async PluginDriver.hookFirstAndGetPlugin (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:22308:28)\u001b[39m\n",
  "combined": "\n> tanstack-react-start-e2e-import-protection@ build /Users/caligano/source/import-protection/router-import-protection/e2e/react-start/import-protection\n> vite build && tsc --noEmit\n\n\u001b[36mvite v7.3.1 \u001b[32mbuilding client environment for production...\u001b[36m\u001b[39m\ntransforming...\n\u001b[32m✓\u001b[39m 152 modules transformed.\n\u001b[41m\u001b[30m ELIFECYCLE \u001b[39m\u001b[49m \u001b[31mCommand failed with exit code 1.\u001b[39m\n\n\u001b[31m✗\u001b[39m Build failed in 719ms\n\u001b[31merror during build:\n\u001b[31m[commonjs--resolver] [plugin tanstack-start-core:import-protection] \n[import-protection] Import denied in client environment\n\n  Denied by specifier pattern: @tanstack/react-start/server\n  Importer: src/violations/leaky-server-import.ts:7:10\n  Import: \"@tanstack/react-start/server\"\n\n  Trace:\n    1. src/router.tsx:2:27 (entry) (import \"./routeTree.gen\")\n    2. src/routeTree.gen.ts:6:55 (import \"./routes/leaky-server-import\")\n    3. src/routes/leaky-server-import.tsx:2:38 (import \"../violations/leaky-server-import\")\n    4. src/violations/leaky-server-import.ts:7:10 (import \"@tanstack/react-start/server\")\n\n  Code:\n    5 | export function leakyGetRequestUsage() {\n    6 |   // Any reference keeps the import alive.\n  > 7 |   return getRequest()\n      |          ^\n    8 | }\n    9 | \n\n  src/violations/leaky-server-import.ts:7:10\n\n  Suggestions:\n    - Use createServerFn().handler(() => ...) to keep the logic on the server and call it from the client via an RPC bridge\n    - Use createServerOnlyFn(() => ...) to mark it as server-only (it will throw if accidentally called from the client)\n    - Use createIsomorphicFn().client(() => ...).server(() => ...) to provide separate client and server implementations\n    - Move the server-only import out of this file into a separate .server.ts module that is not imported by any client code\n\u001b[31m\n    at getRollupError (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/parseAst.js:401:41)\n    at error (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/parseAst.js:397:42)\n    at Object.error (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:22104:20)\n    at Object.handleViolation (file:///Users/caligano/source/import-protection/router-import-protection/packages/start-plugin-core/dist/esm/import-protection-plugin/plugin.js:652:23)\n    at Object.resolveId (file:///Users/caligano/source/import-protection/router-import-protection/packages/start-plugin-core/dist/esm/import-protection-plugin/plugin.js:452:34)\n    at async PluginDriver.hookFirstAndGetPlugin (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:22308:28)\n    at async resolveId (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:20785:26)\n    at async ModuleLoader.resolveId (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:21221:15)\n    at async Object.resolveId (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/vite@7.3.1_@types+node@25.0.9_jiti@2.6.1_lightningcss@1.30.2_sass-embedded@1.97.2_sass@_1d37aa1356b156747ad30a49305c26bc/node_modules/vite/dist/node/chunks/config.js:4154:21)\n    at async PluginDriver.hookFirstAndGetPlugin (file:///Users/caligano/source/import-protection/router-import-protection/node_modules/.pnpm/rollup@4.52.5/node_modules/rollup/dist/es/shared/node-entry.js:22308:28)\u001b[39m\n"
}