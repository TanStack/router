---
id: migrate-from-next-js
title: Migrate from Next.js
---

> TODO: Can change the title/headline as required.

This guide provides a step-by-step process to migrate a project from the Next.js App Router to **TanStack Start**. We respect the powerful features of Next.js and aim to make this transition as smooth and professional as possible.

## Step-by-Step (Basics)

- ### 0. Prerequisites

  You can clone the following [starter template](https://github.com/nrjdalal/awesome-templates/tree/main/next.js-apps/next.js-start) to follow along with this guide:

  ```shell
  npx gitpick nrjdalal/awesome-templates/tree/main/next.js-apps/next.js-start next.js-start-er
  ```

  This starter is a basic Next.js application using the App Router, which we will migrate to **TanStack Start**.

- ### 1. Remove Next.js

  First, uninstall Next.js and remove adjacent configuration files:

  ```shell
  npm uninstall @tailwindcss/postcss next
  rm postcss.config.* next.config.*
  ```

- ### 2. Install Required Dependencies

  **TanStack Start** leverages Vite and TanStack Router:

  ```shell
  npm i @tanstack/react-router@alpha @tanstack/react-start@alpha vite
  ```

  For TypeScript support and Tailwind CSS:

  ```shell
  npm i -D @tailwindcss/vite tailwindcss vite-tsconfig-paths
  ```

  > Note: We use `@alpha` tags until the packages reach stability.

- ### 3. Update Project Configuration

- `package.json`

  ```json
  {
    "type": "module",
    "scripts": {
      "dev": "vite dev",
      "build": "vite build",
      "start": "node .output/server/index.mjs"
    }
  }
  ```

- `vite.config.ts`

  ```ts
  import tailwindcss from '@tailwindcss/vite'
  import { tanstackStart } from '@tanstack/react-start/plugin/vite'
  import { defineConfig } from 'vite'
  import tsConfigPaths from 'vite-tsconfig-paths'

  export default defineConfig({
    server: {
      port: 3000,
    },
    plugins: [
      tailwindcss(),
      // Enables Vite to resolve imports using path aliases.
      tsConfigPaths(),
      tanstackStart({
        tsr: {
          // Specifies the directory TanStack Router uses for your routes.
          routesDirectory: 'src/app', // Defaults to "src/routes"
        },
      }),
    ],
  })
  ```

  By default, `routesDirectory` is set to `src/routes`. If you want to maintain consistency with Next.js App Router conventions, you can set it to `src/app` instead.

- ### 4. Adapt the Root Layout

  > **TanStack Start** uses a routing adjacent to Remix, but with some changes to make compatible with nested structures and support special features using tokens. You can see all on changes in the [Routing Concepts](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts) guide.

  Instead of `layout.tsx`, you will create a file named `__root.tsx` in the `src/app` directory. This file will serve as the root layout for your application.

- `src/app/layout.tsx` to `src/app/__root.tsx`

  ```tsx
  - import type { Metadata } from "next" // [!code --]
  import {
    Outlet,
    createRootRoute,
    HeadContent,
    Scripts,
  } from "@tanstack/react-router"
  import "./globals.css"

  - export const metadata: Metadata = { // [!code --]
  -   title: "Create Next App", // [!code --]
  -   description: "Generated by create next app", // [!code --]
  - } // [!code --]
  export const Route = createRootRoute({
    head: () => ({
      meta: [
        { charSet: "utf-8" },
        {
          name: "viewport",
          content: "width=device-width, initial-scale=1",
        },
        { title: "TanStack Start Starter" }
      ],
    }),
    component: RootLayout,
  })

  - export default function RootLayout({ // [!code --]
  -   children, // [!code --]
  - }: Readonly<{ // [!code --]
  -   children: React.ReactNode // [!code --]
  - }>) { // [!code --]
  -   return ( // [!code --]
  -     <html lang="en"> // [!code --]
  -       <body>{children}</body> // [!code --]
  -     </html> // [!code --]
  -   ) // [!code --]
  - } // [!code --]
  function RootLayout() {
    return (
      <html lang="en">
        <head>
          <HeadContent />
        </head>
        <body>
          <Outlet />
          <Scripts />
        </body>
      </html>
    )
  }
  ```

- ### 5. Adapt the Home Page

  > TODO: Should we callout that it is this way since you are referencing the index route and not the layout route. Hence why the index token is being used.

  Instead of `page.tsx`, you will create an `index.tsx` file for the `/` route.

- `src/app/page.tsx` to `src/app/index.tsx`

  ```tsx
  - export default function Home() { // [!code --]
  + export const Route = createFileRoute({ // [!code ++]
  +   component: Home, // [!code ++]
  + }) // [!code ++]

  + function Home() { // [!code ++]
    return (
      <main className="min-h-dvh w-screen flex items-center justify-center flex-col gap-y-4 p-4">
        <img
          className="max-w-sm w-full"
          src="https://tanstack.com/assets/splash-dark-8nwlc0Nt.png"
          alt="TanStack Logo"
        />
        <h1>
          <span className="line-through">Next.js</span> TanStack Start
        </h1>
        <a
          className="bg-foreground text-background rounded-full px-4 py-1 hover:opacity-90"
          href="https://tanstack.com/start/latest"
          target="_blank"
        >
          Docs
        </a>
      </main>
    )
  }
  ```

- ### 6. Are we migrated yet?

  One last thing before we can run the development server, we need to create a router file that will dictate the behavior of TanStack Router used within **TanStack Start**.

- `src/router.tsx`

  ```tsx
  import { createRouter as createTanStackRouter } from '@tanstack/react-router'
  import { routeTree } from './routeTree.gen'

  export function createRouter() {
    const router = createTanStackRouter({
      routeTree,
      scrollRestoration: true,
    })

    return router
  }

  declare module '@tanstack/react-router' {
    interface Register {
      router: ReturnType<typeof createRouter>
    }
  }
  ```

  > Here you can configure everything from the default [preloading functionality](https://tanstack.com/router/latest/docs/framework/react/guide/preloading) to [caching staleness](https://tanstack.com/router/latest/docs/framework/react/guide/data-loading).

- ### 7. Verify the Migration

  Run the development server:

  ```shell
  npm run dev
  ```

  Then visit http://localhost:3000. You should see the **TanStack Start** welcome page with its logo and documentation link.

  > If you encounter issues, review the steps above and ensure file names and paths match exactly. For reference implementation, see the [after migration repository](https://github.com/nrjdalal/next-to-start).

## Next Steps (Advanced)

- ### Routing Concepts

  | Route Example               | Next.js                         | TanStack Start            |
  | --------------------------- | ------------------------------- | ------------------------- |
  | Root Layout                 | `src/app/layout.tsx`            | `src/app/__root.tsx`      |
  | `/` (Home Page)             | `src/app/page.tsx`              | `src/app/index.tsx`       |
  | `/posts` (Static Route)     | `src/app/posts/page.tsx`        | `src/app/posts.tsx`       |
  | `/posts/:slug` (Dynamic)    | `src/app/posts/[slug]/page.tsx` | `src/app/posts/$slug.tsx` |
  | `/api/endpoint` (API Route) | `src/app/api/endpoint/route.ts` | `src/app/api/endpoint.ts` |

  Learn more about the [Routing Concepts](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts).

- ### Dynamic and Catch-All Routes

  Getting dynamic route parameters in **TanStack Start** is straightforward.

  ```tsx
  - export default async function Page({ // [!code --]
  -   params, // [!code --]
  - }: { // [!code --]
  -   params: Promise<{ slug: string }> // [!code --]
  - }) { // [!code --]
  + export const Route = createFileRoute({ // [!code ++]
  +   component: Page, // [!code ++]
  + }) // [!code ++]

  + function Page() { // [!code ++]
  -   const { slug } = await params // [!code --]
  +   const { slug } = Route.useParams() // [!code ++]
    return <div>My Post: {slug}</div>
  }
  ```

  Similarly, you can get `searchParams` like `const { page, filter, sort } = Route.useSearch()`.

  Learn more about the [Dynamic and Catch-All Routes](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts#dynamic-route-segments).

- ### Links

  ```tsx
  - import Link from "next/link" // [!code --]
  + import { Link } from "@tanstack/react-router" // [!code ++]

  function Component() {
  -   return <Link href="/dashboard">Dashboard</Link> // [!code --]
  +   return <Link to="/dashboard">Dashboard</Link> // [!code ++]
  }
  ```

  Learn more about the [Links](https://tanstack.com/start/latest/docs/framework/react/learn-the-basics#navigation).

- ### Server ~Actions~ Functions

  ```tsx
  - 'use server' // [!code --]
  + import { createServerFn } from "@tanstack/react-start" // [!code ++]

  - export const create = async () => { // [!code --]
  + export const create = createServerFn().handler(async () => { // [!code ++]
    return true
  - } // [!code --]
  + }) // [!code ++]
  ```

  Learn more about the [Server Functions](https://tanstack.com/start/latest/docs/framework/react/server-functions).

- ### Server Routes ~Handlers~

  ```ts
  - export async function GET() { // [!code --]
  + export const ServerRoute = createServerFileRoute().methods({ // [!code ++]
  +   GET: async () => { // [!code ++]
      return Response.json("Hello, World!")
    }
  + }) // [!code ++]
  ```

  Learn more about the [Server Routes](https://tanstack.com/start/latest/docs/framework/react/server-routes).

- ### Fonts

  ```tsx
  - import { Inter } from "next/font/google" // [!code --]

  - const inter = Inter({ // [!code --]
  -   subsets: ["latin"], // [!code --]
  -   display: "swap", // [!code --]
  - }) // [!code --]

  - export default function Page() { // [!code --]
  -   return <p className={inter.className}>Font Sans</p> // [!code --]
  - } // [!code --]
  ```

  Instead of `next/font`, use Tailwind CSSâ€™s CSS-first approach. Install fonts (e.g. from [Fontsource](https://github.com/fontsource/fontsource)):

  ```shell
  npm i -D @fontsource-variable/dm-sans @fontsource-variable/jetbrains-mono
  ```

  Add to `src/app/globals.css`:

  ```css
  @import 'tailwindcss';

  @import '@fontsource-variable/dm-sans'; /* [!code ++] */
  @import '@fontsource-variable/jetbrains-mono'; /* [!code ++] */

  @theme inline {
    --font-sans: 'DM Sans Variable', sans-serif; /* [!code ++] */
    --font-mono: 'JetBrains Mono Variable', monospace; /* [!code ++] */
    /* ... */
  }

  /* ... */
  ```
