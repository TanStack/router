---
id: migrate-from-next-js-app-router
title: Migrate from Next.js App Router
---

- [Migrate from Next.js App Router (Basics)](#migrate-from-nextjs-app-router-basics)
  - [Uninstall Next.js](#uninstall-nextjs)
  - [Install Dependencies](#install-dependencies)
  - [Update Configuration Files](#update-configuration-files)
  - [Update Root Layout](#update-root-layout)
  - [Update Home Page](#update-home-page)
  - [Are we migrated yet?](#are-we-migrated-yet)
  - [Test Your Migration](#test-your-migration)
- [Next Steps (Advanced)](#next-steps-advanced)
  - [Routing Concepts](#routing-concepts)
  - [Dynamic Routes](#dynamic-routes)
  - [Link](#link)
  - [Server ~Actions~ Functions](#server-actions-functions)
  - [Server Routes ~Handlers~](#server-routes-handlers)
  - [Font](#font)

# Migrate from Next.js App Router (Basics)

This guide helps you migrate a Next.js App Router project to TanStack Start. You'll learn how to set up TanStack Start and adapt your existing Next.js code.

To get started, use this Next.js App Router starter template:

```shell
npx gitpick nrjdalal/awesome-templates/tree/main/next.js-apps/next.js-start next.js-start-er
```

> [!Important]
> For advanced features like dynamic routes, links, server actions, route handlers and more, refer to the [Next Steps (Advanced)](#next-steps-advanced) section at the end of this guide.

## Uninstall Next.js

Uninstall Next.js and remove existing configuration files.

```shell
npm uninstall next
rm next.config.* postcss.config.*
```

## Install Dependencies

TanStack Start is powered by [Vite](https://vite.dev) and [TanStack Router](https://tanstack.com/router) and requires them as dependencies.

To install them, run:

```shell
npm i @tanstack/react-router@alpha @tanstack/react-start@alpha vite
```

> [!Note]
> The `@alpha` tag will be removed once the packages are stable.

Some dev dependencies are also required for TypeScript support, path aliases, and Tailwind CSS:

```shell
npm i -D @tailwindcss/postcss postcss tailwindcss vite-tsconfig-paths
```

## Update Configuration Files

We'll then update our `package.json` to use Vite and set `"type": "module"`:

```json
// package.json

{
  "type": "module",
  "scripts": {
    "dev": "vite dev",
    "build": "vite build",
    "start": "node .output/server/index.mjs"
  }
}
```

Then configure TanStack Start's Vite plugin in `vite.config.ts`:

```ts
// vite.config.ts

import { tanstackStart } from '@tanstack/react-start/plugin/vite'
import { defineConfig } from 'vite'
import tsConfigPaths from 'vite-tsconfig-paths'

export default defineConfig({
  server: {
    port: 3000,
  },
  plugins: [
    tsConfigPaths(),
    tanstackStart({
      tsr: {
        // Use "src/app" instead of the default "src/routes"
        routesDirectory: 'src/app',
      },
    }),
  ],
})
```

> [!Note]
> By default, TanStack Start uses the `src/routes` directory to store your routes. If you want to use a different directory, you can specify it in the `tanstackStart` plugin options as shown above.

To work with Tailwind CSS V4, create a `postcss.config.ts` file in the root of your project:

```ts
// postcss.config.ts

export default {
  plugins: {
    '@tailwindcss/postcss': {},
  },
}
```

## Update Root Layout

Create or rename `layout.tsx` to `__root.tsx` and update the content. This file will serve as the root layout for your application, similar to how `layout.tsx` works in Next.js.

```diff
// src/app/layout.tsx -> src/app/__root.tsx

- import type { Metadata } from "next"
import {
  Outlet,
  createRootRoute,
  HeadContent,
  Scripts,
} from "@tanstack/react-router"
import "./globals.css"

- export const metadata: Metadata = {
-   title: "Create Next App",
-   description: "Generated by create next app",
- }
export const Route = createRootRoute({
  head: () => ({
    meta: [
      {
        charSet: "utf-8",
      },
      {
        name: "viewport",
        content: "width=device-width, initial-scale=1",
      },
      {
        title: "TanStack Start Starter",
      },
    ],
  }),
  component: RootLayout,
})

- export default function RootLayout({
-   children,
- }: Readonly<{
-   children: React.ReactNode
- }>) {
-   return (
-     <html lang="en">
-       <body>{children}</body>
-     </html>
-   )
- }
function RootLayout() {
  return (
    <html lang="en">
      <head>
        <HeadContent />
      </head>
      <body>
        <Outlet />
        <Scripts />
      </body>
    </html>
  )
}
```

## Update Home Page

Create or rename `page.tsx` to `index.tsx` and update the content. This file will serve as the home page of your application, similar to how `page.tsx` works in Next.js.

```diff
// src/app/page.tsx -> src/app/index.tsx

- export default function Home() {
+ export const Route = createFileRoute({
+   component: Home,
+ })

+ function Home() {
  return (
    <main className="min-h-dvh w-screen flex items-center justify-center flex-col gap-y-4 p-4">
      <img
        className="max-w-sm w-full"
        src="https://tanstack.com/assets/splash-dark-8nwlc0Nt.png"
        alt="TanStack Logo"
      />
      <h1>
        <span className="line-through">Next.js</span> TanStack Start
      </h1>
      <a
        className="bg-foreground text-background rounded-full px-4 py-1 hover:opacity-90"
        href="https://tanstack.com/start/latest"
        target="_blank"
      >
        Docs
      </a>
    </main>
  )
}
```

## Are we migrated yet?

One last thing to do is to create `src/router.tsx`. This is the file that will dictate the behavior of TanStack Router used within Start. Here, you can configure everything from the default [preloading functionality](https://tanstack.com/router/latest/docs/framework/react/guide/preloading) to [caching staleness](https://tanstack.com/router/latest/docs/framework/react/guide/data-loading).

```tsx
// src/router.tsx

import { createRouter as createTanStackRouter } from '@tanstack/react-router'
import { routeTree } from './routeTree.gen'

export function createRouter() {
  const router = createTanStackRouter({
    routeTree,
    scrollRestoration: true,
  })

  return router
}

declare module '@tanstack/react-router' {
  interface Register {
    router: ReturnType<typeof createRouter>
  }
}
```

## Test Your Migration

To start your application, run the following command in your terminal:

```shell
npm run dev
```

If everything is set up correctly, you should see the TanStack Start home page with the logo and a link to the documentation in your browser at `http://localhost:3000`.

> If you face any issues, double-check the steps above and ensure that all files are correctly named and located in the appropriate directories. Refer to https://github.com/nrjdalal/next-to-start for a complete example of the migration.

---

# Next Steps (Advanced)

The following sections provide example code snippets for common migration tasks.

> [!Note]
> For more details and advanced usage, refer to the linked documentation in each header.

- ### [Routing Concepts](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts)

  | Path       | Next.js                         | TanStack Start            |
  | ---------- | ------------------------------- | ------------------------- |
  | RootLayout | `src/app/layout.tsx`            | `src/app/__root.tsx`      |
  | /          | `src/app/page.tsx`              | `src/app/index.tsx`       |
  | /posts     | `src/app/posts/page.tsx`        | `src/app/posts.tsx`       |
  | /posts/xyz | `src/app/posts/[slug]/page.tsx` | `src/app/posts/$slug.tsx` |
  | /api/hello | `src/app/api/hello/route.ts`    | `src/app/api/hello.ts`    |

  Learn more about [routing concepts](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts).

- ### [Dynamic Routes](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts#dynamic-route-segments)

  ```diff
  - export default async function Page({
  -   params,
  - }: {
  -   params: Promise<{ slug: string }>
  - }) {
  + export const Route = createFileRoute({
  +   component: Home,
  + })

  + function Page() {
  -   const { slug } = await params
  +   const { slug } = Route.useParams()
    return <div>My Post: {slug}</div>
  }
  ```

  Similarly, you can get `searchParams` like `const { page, filter, sort } = Route.useSearch()`.

  Also try, [Splat / Catch-All Routes](https://tanstack.com/router/latest/docs/framework/react/routing/routing-concepts#splat--catch-all-routes).

- ### [Link](https://tanstack.com/start/latest/docs/framework/react/learn-the-basics#navigation)

  ```diff
  - import Link from "next/link"
  + import { Link } from "@tanstack/react-router"

  function Component() {
  -   return <Link href="/dashboard">Dashboard</Link>
  +   return <Link to="/dashboard">Dashboard</Link>
  }
  ```

- ### [Server ~Actions~ Functions](https://tanstack.com/start/latest/docs/framework/react/server-functions)

  Refer the link above for more details on how to add searchParams, body, validation and more.

  ```diff
  - 'use server'
  + import { createServerFn } from '@tanstack/react-start'

  - export const create = async () => {
  + export const create = createServerFn().handler(async () => {
    return true
  - }
  + })
  ```

  Also try, [Static Server Functions](https://tanstack.com/start/latest/docs/framework/react/static-server-functions).

- ### [Server Routes ~Handlers~](https://tanstack.com/start/latest/docs/framework/react/server-routes)

  ```diff
  - export async function GET() {
  + export const ServerRoute = createServerFileRoute().methods({
  +   GET: async () => {
      return Response.json("Hello, World!")
    }
  + })
  ```

- ### Font

  Instead of using the `next/font` package, use recommended Tailwind CSS V4 approach i.e. CSS-first configuration.

  ```diff
  - import { Inter } from "next/font/google"

  - const inter = Inter({
  -   subsets: ["latin"],
  -   display: "swap",
  - })

  - export default function Page() {
  -   return <p className={inter.className}>Font Sans</p>
  - }
  ```

  Select the required local fonts (e.g. from [Fontsource](https://github.com/fontsource/fontsource)) and install them as dev dependencies:

  ```shell
  npm i -D @fontsource-variable/dm-sans @fontsource-variable/jetbrains-mono
  ```

  Then, update your `globals.css` to include the font imports:

  ```css
  /* src/app/globals.css */

  @import 'tailwindcss';

  @import '@fontsource-variable/dm-sans';
  @import '@fontsource-variable/jetbrains-mono';

  @theme inline {
    --font-sans: 'DM Sans Variable', sans-serif;
    --font-mono: 'JetBrains Mono Variable', monospace;
    /* ... */
  }

  /* ... */
  ```
